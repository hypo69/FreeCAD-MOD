# KI-Assistent f√ºr FreeCAD
## Teil 1: Laden von Bildern (PNG, JPG, SVG)

## üìÅ Addon-Struktur (Anfangs)

AIAssistant/
‚îú‚îÄ‚îÄ Resources/
‚îÇ   ‚îî‚îÄ‚îÄ icons/
‚îÇ       ‚îú‚îÄ‚îÄ ai_assistant.svg
‚îÇ       ‚îî‚îÄ‚îÄ load_image.svg
‚îú‚îÄ‚îÄ InitGui.py
‚îú‚îÄ‚îÄ ai_assistant_workbench.py
‚îî‚îÄ‚îÄ data/                     ‚Üê Ordner f√ºr Projektdaten (Bilder, Texte)


> üí° Der Ordner `data/` wird **innerhalb des FreeCAD-Benutzerverzeichnisses** erstellt, um das Stammverzeichnis nicht zu √ºberladen.

---

## üìÑ 1. `InitGui.py`
```python
# InitGui.py
import FreeCADGui
from AIAssistant.ai_assistant_workbench import AIAssistantWorkbench

FreeCADGui.addWorkbench(AIAssistantWorkbench())
```

---

## üìÑ 2. `ai_assistant_workbench.py` (Teil 1: Bild laden)

```python
# ai_assistant_workbench.py
import FreeCAD, FreeCADGui
import os
import shutil
from pathlib import Path
from PySide import QtGui, QtCore

# Ordner f√ºr AIAssistant-Daten (Bilder, Texte usw.)
AI_DATA_DIR = os.path.join(FreeCAD.getUserAppDataDir(), "AIAssistant", "data")
os.makedirs(AI_DATA_DIR, exist_ok=True)

class LoadImageCommand:
    def GetResources(self):
        icon_path = os.path.join(os.path.dirname(__file__), "Resources", "icons", "load_image.svg")
        return {
            "MenuText": "Load Image",
            "ToolTip": "Load an image (PNG, JPG, SVG) into AIAssistant workspace",
            "Pixmap": icon_path
        }

    def Activated(self):
        files, _ = QtGui.QFileDialog.getOpenFileNames(
            None,
            "Select Image Files",
            "",
            "Image Files (*.png *.jpg *.jpeg *.bmp *.svg *.gif)"
        )
        if not files:
            return

        for src in files:
            filename = os.path.basename(src)
            dst = os.path.join(AI_DATA_DIR, filename)
            
            # Eindeutiger Name bei Konflikt
            if os.path.exists(dst):
                name, ext = os.path.splitext(filename)
                counter = 1
                while os.path.exists(os.path.join(AI_DATA_DIR, f"{name}_{counter}{ext}")):
                    counter += 1
                dst = os.path.join(AI_DATA_DIR, f"{name}_{counter}{ext}")
            
            try:
                shutil.copy2(src, dst)
                FreeCAD.Console.PrintMessage(f"[AIAssistant] Image saved: {dst}\n")
            except Exception as e:
                FreeCAD.Console.PrintError(f"[AIAssistant] Failed to copy {filename}: {str(e)}\n")
                QtGui.QMessageBox.critical(None, "Error", f"Failed to copy {filename}:\n{str(e)}")

    def IsActive(self):
        return True


class AIAssistantWorkbench(FreeCADGui.Workbench):
    MenuText = "AI Assistant"
    ToolTip = "AI-powered design assistant (Part 1: Image Loader)"

    def __init__(self):
        self.Icon = os.path.join(os.path.dirname(__file__), "Resources", "icons", "ai_assistant.svg")

    def Initialize(self):
        self.list = ["LoadImageCommand"]
        self.appendToolbar("AI Tools", self.list)
        self.appendMenu("AI Assistant", self.list)

    def GetClassName(self):
        return "Gui::PythonWorkbench"


FreeCADGui.addCommand("LoadImageCommand", LoadImageCommand())
```

---

## üñº 3. Icons

### `Resources/icons/load_image.svg`
```xml
<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 64 64">
  <rect x="8" y="8" width="48" height="48" fill="none" stroke="black" stroke-width="4"/>
  <circle cx="32" cy="24" r="8" fill="none" stroke="black" stroke-width="4"/>
  <path d="M20 40 L44 40" stroke="black" stroke-width="4"/>
</svg>
```

### `Resources/icons/ai_assistant.svg`
‚Üí Sie k√∂nnen `load_image.svg` vor√ºbergehend kopieren oder ein einfaches "Gehirn"-Symbol verwenden:

```xml
<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 64 64">
  <circle cx="32" cy="32" r="28" fill="none" stroke="black" stroke-width="4"/>
  <path d="M22 28 Q32 20 42 28" stroke="black" stroke-width="4" fill="none"/>
  <path d="M22 36 Q32 44 42 36" stroke="black" stroke-width="4" fill="none"/>
</svg>
```

---

## üìÅ Wo werden die Daten gespeichert?

Nach dem Laden wird das Bild gespeichert unter:

```
%APPDATA%\FreeCAD\AIAssistant\data\your_image.png
```

Diese Struktur ist **bereit zur Erweiterung**:
- Zuk√ºnftig werden wir hier auch `.md`, `.txt` speichern
- Es kann `project.json` f√ºr Metadaten hinzugef√ºgt werden
- Alles ist isoliert ‚Äî st√∂rt andere Addons nicht

---

## ‚ñ∂Ô∏è Wie √ºberpr√ºfen?

1. Erstellen Sie den Ordner `AIAssistant` in `%APPDATA%\FreeCAD\Mod\`
2. Legen Sie alle Dateien dort ab
3. Starten Sie FreeCAD neu
4. W√§hlen Sie die Arbeitsumgebung **AI Assistant**
5. Klicken Sie auf **Load Image** ‚Üí w√§hlen Sie PNG/SVG ‚Üí die Datei wird nach `AIAssistant/data/` kopiert

---

## üîú Was kommt in Teil 2?

- Schaltfl√§che **¬´Load Text¬ª**
- Dialog zur Auswahl von `.txt`- oder `.md`-Dateien
- Oder manuelle Texteingabe √ºber den **Markdown-Editor**
- Speichern des Textes im selben `data/`-Ordner
