# ğŸ“˜ Curso de formaciÃ³n: CreaciÃ³n de complementos para FreeCAD  
## LecciÃ³n 3. CreaciÃ³n de objetos 3D: caja paramÃ©trica

> **Objetivo de la lecciÃ³n**: aprender a crear cuerpos sÃ³lidos (cajas, cilindros) a travÃ©s de Python, comprender la estructura del documento de FreeCAD y crear un complemento que construya una pieza paramÃ©trica.

---

## ğŸ§± Parte 1. Â¿CÃ³mo estÃ¡ estructurado un documento en FreeCAD?

Antes de crear objetos, es importante comprender la **jerarquÃ­a de datos** en FreeCAD:

```
Document (documento)
â””â”€â”€ Object (objeto)
    â””â”€â”€ Shape (geometrÃ­a)
```

- **Document** â€” es un archivo abierto (`.FCStd`). Todo lo que cree se encuentra dentro del documento.
- **Object** â€” es un objeto paramÃ©trico: caja, cilindro, boceto, etc.
- **Shape** â€” es un cuerpo geomÃ©trico (B-Rep) que se puede visualizar.

> ğŸ’¡ Siempre trabaja **en el contexto del documento activo**.

### Â¿CÃ³mo obtener el documento actual?

```python
doc = FreeCAD.ActiveDocument
```

Si no hay un documento, cree uno nuevo:

```python
doc = FreeCAD.newDocument("MyDesign")
```

---

## ğŸ“¦ Parte 2. CreaciÃ³n de una caja (Box) a travÃ©s de Python

El objeto 3D mÃ¡s simple en FreeCAD es **Part::Box**.

Ejemplo de cÃ³digo:
```python
doc = FreeCAD.ActiveDocument or FreeCAD.newDocument()
box = doc.addObject("Part::Box", "MyBox")
box.Length = 20.0
box.Width = 10.0
box.Height = 5.0
doc.recompute()
```

### Â¿QuÃ© sucede aquÃ­?

1. `doc.addObject("Part::Box", "MyBox")`  
   â†’ crea un nuevo objeto de tipo **Box** con el nombre `"MyBox"`
2. El objeto tiene **propiedades paramÃ©tricas**: `Length`, `Width`, `Height`
3. `doc.recompute()`  
   â†’ reconstruye el modelo (Â¡obligatorio despuÃ©s de cambiar los parÃ¡metros!)

> ğŸ”¸ Todas las dimensiones estÃ¡n en **milÃ­metros** (por defecto en FreeCAD).

---

## ğŸ›  Parte 3. Complemento: Â«Caja paramÃ©tricaÂ»

Ahora crearemos un complemento que crea una caja con las dimensiones especificadas.

### Paso 1. Cree una carpeta

```
.../Mod/ParamBoxAddon/
```

### Paso 2. Archivo `InitGui.py`

```python
# InitGui.py
import FreeCADGui
from ParamBoxAddon.param_box_workbench import ParamBoxWorkbench

FreeCADGui.addWorkbench(ParamBoxWorkbench())
```

### Paso 3. Archivo `param_box_workbench.py`

```python
# param_box_workbench.py
import FreeCAD, FreeCADGui

class CreateBoxCommand:
    def GetResources(self):
        return {
            "MenuText": "Create Box",
            "ToolTip": "Create a parametric box with default size"
        }

    def Activated(self):
        # Obtener o crear un documento
        doc = FreeCAD.ActiveDocument
        if not doc:
            doc = FreeCAD.newDocument("BoxDesign")

        # Crear objeto Box
        box = doc.addObject("Part::Box", "MyParamBox")
        box.Length = 30.0
        box.Width = 20.0
        box.Height = 10.0

        # Â¡Recalcular es obligatorio!
        doc.recompute()

        # Opcional: enfocar en el objeto
        FreeCADGui.Selection.clearSelection()
        FreeCADGui.Selection.addSelection(box)

    def IsActive(self):
        return True


class ParamBoxWorkbench(FreeCADGui.Workbench):
    MenuText = "Parametric Box"
    ToolTip = "Create a simple parametric box"

    def Initialize(self):
        self.list = ["CreateBoxCommand"]
        self.appendToolbar("Box Tools", self.list)
        self.appendMenu("ParamBox", self.list)

    def GetClassName(self):
        return "Gui::PythonWorkbench"


FreeCADGui.addCommand("CreateBoxCommand", CreateBoxCommand())
```

---

## â–¶ï¸ Paso 4. ComprobaciÃ³n del funcionamiento

1. Guarde los archivos
2. Reinicie FreeCAD
3. Seleccione el entorno de trabajo **Â«Parametric BoxÂ»**
4. Haga clic en el botÃ³n **Â«Create BoxÂ»**

âœ… DeberÃ­a aparecer un **paralelepÃ­pedo gris** en la ventana 3D.

### Â¡Compruebe la parametricidad!

1. En el **Ã¡rbol del proyecto** (Modelo), haga doble clic en `MyParamBox`
2. En el panel **Datos**, cambie, por ejemplo, `Length` a `50`
3. Pulse **Enter** â†’ Â¡el modelo **se actualizarÃ¡ automÃ¡ticamente**!

Esto es el **modelado paramÃ©trico**.

---

## ğŸ” Parte 4. Otros objetos bÃ¡sicos

Puede crear no solo cajas. AquÃ­ tiene algunos ejemplos:

### Cilindro
```python
cyl = doc.addObject("Part::Cylinder", "MyCylinder")
cyl.Radius = 10.0
cyl.Height = 25.0
```

### Esfera
```python
sphere = doc.addObject("Part::Sphere", "MySphere")
sphere.Radius = 15.0
```

### Cono
```python
cone = doc.addObject("Part::Cone", "MyCone")
cone.Radius1 = 10.0  # radio inferior
cone.Radius2 = 5.0   # radio superior
cone.Height = 20.0
```

> ğŸ’¡ Todos estos objetos se encuentran en el mÃ³dulo **Part**, que estÃ¡ integrado en FreeCAD.

---

## ğŸ§ª Tarea prÃ¡ctica

1. Modifique el complemento para que cree un **cilindro**, en lugar de una caja.
2. Haga que al crear un objeto, este reciba un **nombre Ãºnico** (por ejemplo, `Box_1`, `Box_2`...), si ya existe un objeto con ese nombre.
3. AÃ±ada un segundo comando â€” Â«Create CylinderÂ» â€” al mismo entorno de trabajo.

Sugerencia para el nombre Ãºnico:
```python
base_name = "MyBox"
index = 1
name = base_name
while name in doc.Objects:
    name = f"{base_name}_{index}"
    index += 1
box = doc.addObject("Part::Box", name)
```

---

## ğŸ’¡ Consejos para la depuraciÃ³n

- Siempre llame a `doc.recompute()` despuÃ©s de cambiar los parÃ¡metros
- Utilice `FreeCAD.Console.PrintMessage("Texto\n")` para la depuraciÃ³n (los mensajes aparecerÃ¡n en la Vista de informe)
- Compruebe si el documento existe antes de trabajar con Ã©l

---

## â–¶ï¸ Â¿QuÃ© sigue?

En la **LecciÃ³n 4** aprenderemos a:
- Crear una **interfaz grÃ¡fica de usuario (GUI)** con campos de entrada
- Crear una ventana donde el usuario introduzca la longitud, la anchura y la altura
- Y al pulsar un botÃ³n, se construirÃ¡ una caja con esos parÃ¡metros

Â¡Esto ya serÃ¡ una **herramienta real**, no solo una demostraciÃ³n!
